version: '1'

services:
  ipmi-explorer-db:
    container_name: ipmi-explorer-db
    image: docker.io/library/mariadb:10.4
    restart: always
    environment:
      MYSQL_USER: root
      MYSQL_ROOT_PASSWORD: password
    healthcheck:
      test: '/usr/local/bin/.healthchecksh --su-mysql --connect --innodb_initialized'
    networks:
      - ipmi-explorer-ntwk
    ports:
      -"3306:3306"

  ipmi-explorer:
    container_name: ipmi-explorer
    build:
      context: .
    depends_on:
      - ipmi-explorer-db
    restart: always
    healthcheck:
      test: 'python healthcheck.py'
    networks:
      - ipmi-explorer-ntwk

networks:
  ipmi-explorer-ntwk: